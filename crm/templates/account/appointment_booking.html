{% extends "account/base.html" %}
{% load static %}

{% block title %}Book Appointment - Channab{% endblock title %}

{% block extra_css %}
<link href="{% static 'libs/select2/css/select2.min.css' %}" rel="stylesheet" type="text/css" />
<style>
    /* Add any custom styles here */
</style>
{% endblock extra_css %}

{% block content %}
<div class="main-content">
    <div class="page-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                        <h4 class="mb-sm-0">Book Appointment</h4>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title mb-4">Appointment Details</h5>
                            <form method="post" id="appointment-form">
                                {% csrf_token %}
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="id_city" class="form-label">City</label>
                                        <select class="form-select" id="id_city" name="city" required>
                                            <option value="">Select City</option>
                                            {% for city in cities %}
                                            <option value="{{ city.id }}">{{ city.name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="id_area" class="form-label">Area</label>
                                        {{ form.area }}
                                    </div>
                                    <div class="col-md-6">
                                        <label for="id_service" class="form-label">Service</label>
                                        {{ form.service }}
                                    </div>
                                    <div class="col-md-6">
                                        <label for="id_appointment_date" class="form-label">Appointment Date</label>
                                        {{ form.appointment_date }}
                                    </div>
                                    <div class="col-md-6">
                                        <label for="id_appointment_time" class="form-label">Appointment Time</label>
                                        {{ form.appointment_time }}
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <button type="submit" class="btn btn-primary">Book Appointment</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include "partials/footer.html" %}
</div>
{% endblock content %}

{% block extra_js %}
<script src="{% static 'libs/select2/js/select2.min.js' %}"></script>
<script>
    $(document).ready(function() {
        $('#id_city, #id_area, #id_service').select2();

        $('#id_city').change(function() {
            var cityId = $(this).val();
            if (cityId) {
                $.ajax({
                    url: "{% url 'get_areas' %}",
                    data: {
                        'city_id': cityId
                    },
                    success: function(data) {
                        $('#id_area').html(data);
                    }
                });
            } else {
                $('#id_area').html('<option value="">Select Area</option>');
            }
        });
    });
</script>
{% endblock extra_js %}